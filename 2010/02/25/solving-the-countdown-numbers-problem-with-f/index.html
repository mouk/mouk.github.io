<!DOCTYPE html>
<html class="fuelux" lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv='Content-Type' content='text/html; charset=utf-8'>
    <title>Solving the Countdown Numbers Problem with F#</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Technical Web Development Blog">
    <meta name="author" content="Garry Welding">
    <script src="/js/all.js" type="text/javascript"></script>
	<link href="/css/all.css" rel="stylesheet">	
	
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/favicon.ico">
  </head>
  <body data-spy="scroll" data-target=".subnav" data-offset="50">
    <div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <a class="brand" href="http://mouk.github.io">Abstract AST</a>
            <div class="nav-collapse">
                <ul class="nav">
                    <li class="">
                        <a href="http://mouk.github.io"><i class="icon-home"></i> Home</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="icon-list"></i> Projects <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            <li class=""><a href="https://github.com/gkwelding/WSDLInterpreter" title="take me to the WSDLInterpreter github page" target="_blank">WSDLInterpreter</a></li>
                            <li class=""><a href="https://github.com/gkwelding/Scene7WSDLPHPWrapper" title="take me to the Scene7WSDLPHPWrapper github page" target="_blank">Adobe Scene7 WSDL PHP Wrapper</a></li>
                            <li class=""><a href="https://github.com/gkwelding/GoogleMapsV3CI" title="take me to the Google Maps V3 API for CodeIgniter github page" target="_blank">Google Maps V3 API for CodeIgniter</a></li>
                            <li class=""><a href="https://github.com/gkwelding/MailchimpAPICI" title="take me to the MailChimp API for CodeIgniter github page" target="_blank">MailChimp API for CodeIgniter</a></li>
                            <li class=""><a href="https://github.com/gkwelding/FuelPHP-Social-Package" title="take em to the FuelPHP Social Package github page" target="_blank">FuelPHP Social Package</a></li>
                            <li class=""><a href="https://github.com/gkwelding/Bugzilla-Command-Line-Stats" title="take em to the Bugzilla Command Line Stats github page" target="_blank">Bugzilla Command Line Stats</a></li>
                            <li class=""><a href="https://github.com/gkwelding/ihelp" title="Make em to the iHelp jQuery Plugin github page" target="_blank">iHelp jQuery Plugin</a></li>
                        </ul>
                    </li>
                    <li id="search" class="search hidden-phone hidden-tablet">
                        <span class="icon search"></span>
                        <input type="text" placeholder="search">
                        <i id="close" class="icon-remove"></i>
                        <ol id="search-results" class="dropdown-menu">
                        </ol>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

    <div class="container">
        <div class="content">
            <div class="row">
                <div class="span7 columns">
                    <div class="content">    
    <div class="row">	
        <div class="span7 column">
            <h1>Solving the Countdown Numbers Problem with F#</h1>
        </div>
    </div>
    
    <div class="row">	
        <div class="span7 columns">
            <p>Countdown Problem is a game from the UK TV described in the following <a href="http://www.cs.nott.ac.uk/~gmh/countdown.pdf">link</a> (PDF).&#160; Basically, giving a set of numbers&#160; and a single number, you have to use the arithmetic&#160; operation to build a expression of the given numbers (in any subset and order) , that evaluate to the specified number.&#160;&#160; I will call this task in this article “The Countdown Problem”, since using the word “Problem” makes it sounds more as an academic (or as a homework , see the first comment on my <a href="http://stackoverflow.com/questions/1563271/3d-bin-packing-algorithm">question</a> on Stackoverflow).</p>  <p>&#160;</p>  <p>I came across this Problem after watching the &quot;Functional Programming Fundamentals” <a href="http://channel9.msdn.com/shows/Going+Deep/Lecture-Series-Erik-Meijer-Functional-Programming-Fundamentals-Chapter-1/">series</a> on Channel9, with Erik Mejer. <a href="http://www.cs.nott.ac.uk/~gmh/">Graham Hutton</a> (the author of <a href="http://www.cs.nott.ac.uk/~gmh/book.html">Programming in Haskell</a>) guest-hosted the 11th episode and showed how to solve this problem using brute force with Haskell. As I’m learning F# currently I started to implement the program in F# as well. Despite being heavily based on the Haskell solution from that episode, this code is not an accurate translation of the Haskell code. It just uses the same ideas.</p>  <p>&#160;</p>  <p>At first let us make a structure to hold the possible operations:</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:2EC9848E-067D-4e79-BAB7-06CA927DB962:8134d21b-f087-411f-a68a-f8475133ca75" class="wlWriterEditableSmartContent"><div style="font-family:consolas,lucida console,courier,monospace">
<span style="color:#008000"><b>type</b></span>&#160;<span style="color:#0000FF"><b>Op</b></span>&#160;<span style="color:#666666">=</span>&#160;<span style="color:#0000FF"><b>Add</b></span>&#160;<span style="color:#666666">|</span>&#160;<span style="color:#0000FF"><b>Sub</b></span>&#160;<span style="color:#666666">|</span>&#160;<span style="color:#0000FF"><b>Mul</b></span>&#160;<span style="color:#666666">|</span>&#160;<span style="color:#0000FF"><b>Div</b></span><br />
</div>
</div>  <p>This kind of types is called <a href="http://msdn.microsoft.com/en-us/library/dd233226(VS.100).aspx">discriminated unions</a> which means that an instance of this type is one of the named cases. An operation could be any of the following cases: Addition, Subtraction, multiplication or division.</p>  <p>The second type is an arithmetic expression, which may either be an integer or two expressions combined using an operation from the previous ones:</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:2EC9848E-067D-4e79-BAB7-06CA927DB962:fd51dbeb-f806-48d1-b9bc-ae122239b7d0" class="wlWriterEditableSmartContent"><div style="font-family:consolas,lucida console,courier,monospace">
<span style="color:#008000"><b>type</b></span>&#160;<span style="color:#0000FF"><b>Expr</b></span>&#160;<span style="color:#666666">=</span>&#160;<span style="color:#0000FF"><b>Val</b></span>&#160;<span style="color:#008000"><b>of</b></span>&#160;<span style="color:#B00040">int</span>&#160;<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<span style="color:#666666">|</span>&#160;&#160;<span style="color:#0000FF"><b>App</b></span>&#160;<span style="color:#008000"><b>of</b></span>&#160;<span style="color:#0000FF"><b>Op</b></span>&#160;<span style="color:#666666">*</span>&#160;<span style="color:#0000FF"><b>Expr</b></span>&#160;<span style="color:#666666">*</span>&#160;<span style="color:#0000FF"><b>Expr</b></span><br />
</div>
</div>  <p>Boy, I love discriminated unions ;)</p>  <p>&#160;</p>  <p>Now we have the structures to hold the possible combinations, we still have to generate then in some way. For a set of numbers&#160; we have to generate all possible subsets, and for each of those subsets all permutations have to be generated. Its obvious that this task can be composed from two separate functions: building subsets and permutating them.</p>  <p>The first function generate all subsets of the set of numbers:</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:2EC9848E-067D-4e79-BAB7-06CA927DB962:d78262cc-7d71-4adc-8e55-2355970c4962" class="wlWriterSmartContent">   <div style="font-family: consolas,lucida console,courier,monospace">     <br /><span style="color: #008000"><b>let</b></span>&#160;<span style="color: #008000"><b>rec</b></span> subSets items <span style="color: #666666">=</span>       <p>&#160;&#160;&#160; <span style="color: #008000"><b>match</b></span> items <span style="color: #008000"><b>with</b></span></p>      <p>&#160;&#160;&#160; <span style="color: #666666">|</span>&#160;<span style="color: #008000">[]</span>&#160;<span style="color: #666666">-&gt;</span> seq<span style="color: #666666">{</span>yield <span style="color: #008000">[]</span><span style="color: #666666">}</span></p>      <p>&#160;&#160;&#160; <span style="color: #666666">|</span> x<span style="color: #666666">::</span>xs <span style="color: #666666">-&gt;</span> seq<span style="color: #666666">{</span></p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #008000"><b>let</b></span> sub <span style="color: #666666">=</span> subSets xs</p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; yield<span style="color: #666666">!</span> sub</p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; yield<span style="color: #666666">!</span> sub <span style="color: #666666">|&gt;</span>&#160;<span style="color: #0000ff"><b>Seq</b></span>.map <span style="color: #666666">(</span><span style="color: #008000"><b>fun</b></span> l <span style="color: #666666">-&gt;</span> x<span style="color: #666666">::</span>l<span style="color: #666666">)</span>&#160;<span style="color: #666666">}</span></p>   </div> </div>  <p>This exploits the simple idea that for each element of the set there are two almost identical categories of subsets;&#160; subsets that include this element, and the matching subsets that don’t. This could be exploited using an inductive approach to generate the subsets of small sets and then adding new elements successively to those sets.&#160; This function returns a sequence instead of an instance of Set because the number of subsets is exponential to the number of elements in the original set.&#160; Sequences are lazy evaluated, and thus consume less memory. There are 2<sup>n</sup> subsets of any set of n elements.</p>  <p>The Second function generates for a giving set&#160; alls possible permutations:</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:2EC9848E-067D-4e79-BAB7-06CA927DB962:dddd41bf-874d-4005-81c7-f6f8b0027f7d" class="wlWriterSmartContent">   <div style="font-family: consolas,lucida console,courier,monospace">     <br /><span style="color: #008000"><b>let</b></span>&#160;<span style="color: #008000"><b>rec</b></span> permutations items <span style="color: #666666">=</span>       <p>&#160;&#160;&#160; <span style="color: #008000"><b>match</b></span> items <span style="color: #008000"><b>with</b></span></p>      <p>&#160;&#160;&#160; <span style="color: #666666">|</span>&#160;<span style="color: #008000">[]</span>&#160;<span style="color: #666666">-&gt;</span> seq<span style="color: #666666">{</span>yield <span style="color: #008000">[]</span><span style="color: #666666">}</span></p>      <p>&#160;&#160;&#160; <span style="color: #666666">|</span>&#160;<span style="color: #666666">_</span>&#160;<span style="color: #666666">-&gt;</span>&#160; seq<span style="color: #666666">{</span><span style="color: #008000"><b>for</b></span> x <span style="color: #008000"><b>in</b></span> items <span style="color: #008000"><b>do</b></span></p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #008000"><b>let</b></span> oth <span style="color: #666666">=</span>&#160;<span style="color: #666666">[</span><span style="color: #008000"><b>for</b></span> c <span style="color: #008000"><b>in</b></span> items <span style="color: #008000"><b>do</b></span>&#160;<span style="color: #008000"><b>if</b></span> c <span style="color: #666666">&lt;&gt;</span> x <span style="color: #008000"><b>then</b></span> yield c <span style="color: #666666">]</span></p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; yield<span style="color: #666666">!</span> permutations oth <span style="color: #666666">|&gt;</span>&#160;<span style="color: #0000ff"><b>Seq</b></span>.map <span style="color: #666666">(</span><span style="color: #008000"><b>fun</b></span> l <span style="color: #666666">-&gt;</span> x<span style="color: #666666">::</span>l<span style="color: #666666">)</span>&#160;<span style="color: #666666">}</span></p>   </div> </div>  <p>This function returns n! different permutations for each set of n elements.</p>  <p>Now we can compose both methods to retrieve a method that generates all permutations of all subsets of a given set:</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:2EC9848E-067D-4e79-BAB7-06CA927DB962:f0580702-8ba5-460d-8379-64f917f81eda" class="wlWriterSmartContent">   <div style="font-family: consolas,lucida console,courier,monospace">     <br /><span style="color: #008000"><b>let</b></span> choices items <span style="color: #666666">=</span>&#160; <p>&#160;&#160;&#160; seq<span style="color: #666666">{</span><span style="color: #008000"><b>for</b></span> x <span style="color: #008000"><b>in</b></span> subSets items <span style="color: #008000"><b>do</b></span>&#160;&#160;&#160; </p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; yield<span style="color: #666666">!</span> permutations x <span style="color: #666666">}</span></p>   </div> </div>  <p>Given a set of n elements, this function returns n!.2<sup>n</sup> different choices, which is a huge number. For n=6 choices yields&#160; 46080&#160; elements.</p>  <p>After building all possible permutated subsets of the number set there is still many ways to combine them into an arithmetic expression.&#160; An arithmetic could be represented as a binary tree. Each node in this tree is an operation and the leaves are numbers. Building a binary tree could be done by splitting combining both binary trees into one with a single root node. This could be repeated recursively for all possible sub trees and possible splitting points to generate all binary trees:</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:2EC9848E-067D-4e79-BAB7-06CA927DB962:6160ad60-4275-456d-8259-5b6e79adf241" class="wlWriterSmartContent">   <div style="font-family: consolas,lucida console,courier,monospace">     <br /><span style="color: #008000"><b>let</b></span>&#160;<span style="color: #008000"><b>rec</b></span> generateExpressions nums <span style="color: #666666">=</span>       <p>&#160;&#160;&#160; <span style="color: #008000"><b>match</b></span> nums <span style="color: #008000"><b>with</b></span></p>      <p>&#160;&#160;&#160; <span style="color: #666666">|</span><span style="color: #008000">[]</span>&#160;<span style="color: #666666">-&gt;</span>&#160;<span style="color: #0000ff"><b>Seq</b></span>.empty</p>      <p>&#160;&#160;&#160; <span style="color: #666666">|[</span>a<span style="color: #666666">]</span>&#160;<span style="color: #666666">-&gt;</span> seq<span style="color: #666666">{</span>yield <span style="color: #0000ff"><b>Val</b></span><span style="color: #666666">(</span>a<span style="color: #666666">)}</span></p>      <p>&#160;&#160;&#160; <span style="color: #666666">|_-&gt;</span>seq<span style="color: #666666">{</span><span style="color: #008000"><b>for</b></span> posnum <span style="color: #008000"><b>in</b></span> choices nums <span style="color: #008000"><b>do</b></span></p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #008000"><b>for</b></span>&#160;<span style="color: #666666">(</span>f<span style="color: #666666">,</span>s<span style="color: #666666">)</span>&#160;<span style="color: #008000"><b>in</b></span> split posnum <span style="color: #008000"><b>do</b></span></p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #008000"><b>for</b></span> first <span style="color: #008000"><b>in</b></span> generateExpressions f <span style="color: #008000"><b>do</b></span></p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #008000"><b>for</b></span> second <span style="color: #008000"><b>in</b></span> generateExpressions s <span style="color: #008000"><b>do</b></span></p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #008000"><b>for</b></span> op <span style="color: #008000"><b>in</b></span>&#160;<span style="color: #666666">[</span><span style="color: #0000ff"><b>Add</b></span><span style="color: #666666">;</span><span style="color: #0000ff"><b>Sub</b></span><span style="color: #666666">;</span><span style="color: #0000ff"><b>Mul</b></span><span style="color: #666666">;</span><span style="color: #0000ff"><b>Div</b></span><span style="color: #666666">]</span>&#160;<span style="color: #008000"><b>do</b></span></p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; yield <span style="color: #0000ff"><b>App</b></span><span style="color: #666666">(</span>op<span style="color: #666666">,</span>first<span style="color: #666666">,</span>second<span style="color: #666666">)}</span></p>   </div> </div>  <p>This yields an enormous number of binary trees. For a fixed number of leaves n one could construct (2n)! /((n+a)!n!) different trees.&#160;&#160; We will see in a coming article how to reduce this number by avoiding redundant expressions because of the commutatively of adding and multiplication.&#160;&#160; “split” is the function that splits a list into two non trivial list without changing the order of elements.</p>  <p>&#160;</p>  <p>Now we move to the evaluating arithmetical expressions.&#160; The function “eval” takes an expression and returns an list of integers. This is a common technique when programming in Haskell to express Null. If the expression is valid the function will evaluate it and return a singleton listing containing the result otherwise it will return an empty list.</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:2EC9848E-067D-4e79-BAB7-06CA927DB962:3cf8654f-cc70-4b80-9145-95be8e71b910" class="wlWriterSmartContent">   <div style="font-family: consolas,lucida console,courier,monospace">     <br /><span style="color: #008000"><b>let</b></span>&#160;<span style="color: #008000"><b>rec</b></span> eval expr <span style="color: #666666">=</span>       <p>&#160;&#160;&#160; <span style="color: #008000"><b>match</b></span> expr <span style="color: #008000"><b>with</b></span></p>      <p>&#160;&#160;&#160; <span style="color: #666666">|</span><span style="color: #0000ff"><b>Val</b></span><span style="color: #666666">(</span>n<span style="color: #666666">)</span>&#160;<span style="color: #666666">-&gt;</span>&#160;<span style="color: #666666">[</span>n<span style="color: #666666">]</span></p>      <p>&#160;&#160;&#160; <span style="color: #666666">|</span><span style="color: #0000ff"><b>App</b></span><span style="color: #666666">(</span>op<span style="color: #666666">,</span> left<span style="color: #666666">,</span> right<span style="color: #666666">)</span>&#160; <span style="color: #666666">-&gt;</span>&#160;</p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #666666">[</span><span style="color: #008000"><b>for</b></span> l <span style="color: #008000"><b>in</b></span> eval left <span style="color: #008000"><b>do</b></span></p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #008000"><b>for</b></span> r <span style="color: #008000"><b>in</b></span> eval right <span style="color: #008000"><b>do</b></span></p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #008000"><b>if</b></span> valid op l r <span style="color: #008000"><b>then</b></span></p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; yield apply op l r<span style="color: #666666">]</span></p>   </div> </div>  <p>“valid” is a simple function that ensure that all intermediate results are natural numbers. If valid of sum expression returned false all tree containing the sub tree of this expression are invalid.:</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:2EC9848E-067D-4e79-BAB7-06CA927DB962:c721418c-3404-461c-8ff7-d125f99766c6" class="wlWriterSmartContent">   <div style="font-family: consolas,lucida console,courier,monospace">     <br /><span style="color: #008000"><b>let</b></span> valid op f s&#160; <span style="color: #666666">=</span>&#160; <p>&#160;&#160;&#160; <span style="color: #008000"><b>match</b></span> op <span style="color: #008000"><b>with</b></span></p>      <p>&#160;&#160;&#160; <span style="color: #666666">|</span><span style="color: #0000ff"><b>Add</b></span>&#160;<span style="color: #666666">-&gt;</span>&#160;<span style="color: #008000">true</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; </p>      <p>&#160;&#160;&#160; <span style="color: #666666">|</span><span style="color: #0000ff"><b>Sub</b></span>&#160;<span style="color: #666666">-&gt;</span> f <span style="color: #666666">&gt;=</span> s</p>      <p>&#160;&#160;&#160; <span style="color: #666666">|</span><span style="color: #0000ff"><b>Mul</b></span>&#160;<span style="color: #666666">-&gt;</span>&#160;<span style="color: #008000">true</span>&#160;&#160; </p>      <p>&#160;&#160;&#160; <span style="color: #666666">|</span><span style="color: #0000ff"><b>Div</b></span>&#160;<span style="color: #666666">-&gt;</span>&#160;<span style="color: #666666">(</span>s <span style="color: #666666">&lt;&gt;</span>&#160;<span style="color: #666666">0</span><span style="color: #666666">)</span>&#160;<span style="color: #666666">&amp;&amp;</span>&#160;<span style="color: #666666">(</span>f <span style="color: #666666">%</span> s <span style="color: #666666">=</span>&#160;<span style="color: #666666">0</span><span style="color: #666666">)</span>&#160;&#160; </p>   </div> </div>  <p>Now we have all necessary tools to iterate thru all possible combinations and returning the&#160; ones which matching result:</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:2EC9848E-067D-4e79-BAB7-06CA927DB962:875c5af6-fb12-4320-aadf-b1c21562e7eb" class="wlWriterSmartContent">   <div style="font-family: consolas,lucida console,courier,monospace">     <br /><span style="color: #008000"><b>let</b></span> solutions nums result <span style="color: #666666">=</span>       <p>&#160;&#160;&#160; seq <span style="color: #666666">{</span><span style="color: #008000"><b>for</b></span> ex <span style="color: #008000"><b>in</b></span> generateExpressions nums <span style="color: #008000"><b>do</b></span>&#160;</p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="color: #008000"><b>if</b></span>&#160;<span style="color: #666666">(</span>eval ex <span style="color: #666666">|&gt;</span>&#160;<span style="color: #0000ff"><b>Seq</b></span>.to_list<span style="color: #666666">)</span>&#160;<span style="color: #666666">=</span>&#160;<span style="color: #666666">[</span>result<span style="color: #666666">]</span>&#160;<span style="color: #008000"><b>then</b></span></p>      <p>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; yield ex<span style="color: #666666">}</span></p>   </div> </div>  <p>&#160;</p>  <p>Running this function on the same input as the one presented in the Haskell lecture of Hutton returns the same result:</p>  <div style="padding-bottom: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; float: none; padding-top: 0px" id="scid:2EC9848E-067D-4e79-BAB7-06CA927DB962:75b8ba41-0232-4aa2-a175-b09cebf252ae" class="wlWriterSmartContent">   <div style="font-family: consolas,lucida console,courier,monospace">     <br />solutions <span style="color: #666666">[</span><span style="color: #666666">1</span><span style="color: #666666">;</span>&#160;<span style="color: #666666">3</span><span style="color: #666666">;</span>&#160;<span style="color: #666666">7</span><span style="color: #666666">;</span>&#160;<span style="color: #666666">10</span><span style="color: #666666">;</span>&#160;<span style="color: #666666">25</span><span style="color: #666666">;</span>&#160;<span style="color: #666666">50</span><span style="color: #666666">]</span>&#160;<span style="color: #666666">765</span>&#160;&#160;&#160; <p>&#160;&#160;&#160; <span style="color: #666666">|&gt;</span>&#160;<span style="color: #0000ff"><b>Seq</b></span>.length</p>   </div> </div>  <p>The only problem with this Algorithm is the runtime. It takes too much to calculate the result.</p>  <p>Finding one solution is relative fast, but finding all results takes for ever. In the coming article I will try to reduce the runtime by avoiding redundant arithmetic expressions.</p>  <p>The code exists on <a href="http://github.com/mouk/Countdown">http://github.com/mouk/Countdown</a> and will be updated to reflect the planed changes.</p>

        </div>
    </div>
    
    <div class="pager hidden-phone hidden-tablet">
        <a class="prev" href="/2010/01/10/a-coupon-for-any-tekpub-series-to-give-away/" title="Previous Post: A coupon for any Tekpub series to give away"><i class="icon-arrow-left icon-white"></i></a>
        <a class="next" href="/2010/08/09/harmful-abstractions/" title="Previous Post: Harmful Abstractions"><i class="icon-arrow-right icon-white"></i></a>
    </div>
    
    <div class="row">	
        <div class="span7 column">
            <p>
              <i class="icon-calendar"></i> February 25, 2010
              | <i class="icon-comment"></i> <a href="/2010/02/25/solving-the-countdown-numbers-problem-with-f/#disqus_thread" data-disqus-identifier="/2010/02/25/solving-the-countdown-numbers-problem-with-f/"></a>     
              <br />
              <i class="icon-tags"></i> Tags : <a href="/tags/combinatorics" rel="tooltip" title="View pages tagged with &quot;combinatorics&quot;"><span class="label label-info">combinatorics</span></a>     <a href="/tags/countdown" rel="tooltip" title="View pages tagged with &quot;countdown&quot;"><span class="label label-info">countdown</span></a>     <a href="/tags/f#" rel="tooltip" title="View pages tagged with &quot;f#&quot;"><span class="label label-info">f#</span></a>     <a href="/tags/permutation" rel="tooltip" title="View pages tagged with &quot;permutation&quot;"><span class="label label-info">permutation</span></a>     <a href="/tags/Programming" rel="tooltip" title="View pages tagged with &quot;Programming&quot;"><span class="label label-info">Programming</span></a>   
              <br />
              <a href="https://twitter.com/share" class="twitter-share-button" data-via="dermouk">Tweet</a> <g:plusone size="medium"></g:plusone></h5>
            </p>
        </div>
    </div>

    
    
    <!-- Twitter -->
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

    <!-- Google + -->
    <script type="text/javascript">
      (function() {
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      })();
    </script>
</div>
    

                </div>
                <div class="span4 columns">
                     <h2>About Me</h2>
<p>
    <img src="http://www.gravatar.com/avatar/dd2dbc41e3babec00f70d4becf4092cf?s=160" alt="Moukarram Kabbash" title="Follow me on Twitter @dermouk"  class="img-rounded floatLeft" />
    This blog is kept alive by me,  Moukarram Kabbash, a programmer, hobby photographer from Dortmund in Germany.
</p>					
<p>
    <h6>mouk.github.com</h6> <iframe class="github-btn" src="http://ghbtns.com/github-btn.html?user=mouk&repo=mouk.github.com&type=watch&count=true" allowtransparency="true" frameborder="0" scrolling="0" width="80px" height="20px"></iframe>&nbsp;<iframe class="github-btn" src="http://ghbtns.com/github-btn.html?user=mouk&repo=mouk.github.com&type=fork&count=true" allowtransparency="true" frameborder="0" scrolling="0" width="98px" height="20px"></iframe>
</p>
<p>
    <a href="https://twitter.com/dermouk" class="twitter-follow-button" data-link-color="#0069D6" data-show-count="true">Follow @dermouk</a>
</p>
<p>
    <ul class="buttons unstyled">
        <li><a href="https://github.com/mouk" rel="me" class="social github" title="Go to github.com/mouk" target="_blank"></a></li>
        <li><a href="http://www.twitter.com/dermouk" rel="me" class="social twitter" title="Go to twitter.com/dermouk" target="_blank"></a></li>
        <li><a href="https://github.com/mouk/Feedback/issues/new" rel="me" class="social mail" title="Leave feedback for Moukarram Kabbash"  target="_blank"></a></li>				
    </ul>
</p>
                </div>
                <div class="span4 columns hidden-phone hidden-tablet">
                     <i class="icon-tags"></i> Tags :<br> <a href="/tags/code" rel="tooltip" title="View posts tagged with &quot;code&quot;"><span class="label label-info">code</span></a>     <a href="/tags/codepaste" rel="tooltip" title="View posts tagged with &quot;codepaste&quot;"><span class="label label-info">codepaste</span></a>     <a href="/tags/comparison" rel="tooltip" title="View posts tagged with &quot;comparison&quot;"><span class="label label-info">comparison</span></a>     <a href="/tags/gist" rel="tooltip" title="View posts tagged with &quot;gist&quot;"><span class="label label-info">gist</span></a>     <a href="/tags/github" rel="tooltip" title="View posts tagged with &quot;github&quot;"><span class="label label-info">github</span></a>     <a href="/tags/paste" rel="tooltip" title="View posts tagged with &quot;paste&quot;"><span class="label label-info">paste</span></a>     <a href="/tags/paste-it" rel="tooltip" title="View posts tagged with &quot;paste-it&quot;"><span class="label label-info">paste-it</span></a>     <a href="/tags/pastebin" rel="tooltip" title="View posts tagged with &quot;pastebin&quot;"><span class="label label-info">pastebin</span></a>     <a href="/tags/pastie" rel="tooltip" title="View posts tagged with &quot;pastie&quot;"><span class="label label-info">pastie</span></a>     <a href="/tags/Programming" rel="tooltip" title="View posts tagged with &quot;Programming&quot;"><span class="label label-info">Programming</span></a>     <a href="/tags/C#" rel="tooltip" title="View posts tagged with &quot;C#&quot;"><span class="label label-info">C#</span></a>     <a href="/tags/Castle" rel="tooltip" title="View posts tagged with &quot;Castle&quot;"><span class="label label-info">Castle</span></a>     <a href="/tags/DSL" rel="tooltip" title="View posts tagged with &quot;DSL&quot;"><span class="label label-info">DSL</span></a>     <a href="/tags/IoC" rel="tooltip" title="View posts tagged with &quot;IoC&quot;"><span class="label label-info">IoC</span></a>     <a href="/tags/IronPython" rel="tooltip" title="View posts tagged with &quot;IronPython&quot;"><span class="label label-info">IronPython</span></a>     <a href="/tags/Windsor" rel="tooltip" title="View posts tagged with &quot;Windsor&quot;"><span class="label label-info">Windsor</span></a>     <a href="/tags/XML" rel="tooltip" title="View posts tagged with &quot;XML&quot;"><span class="label label-info">XML</span></a>     <a href="/tags/Gallio" rel="tooltip" title="View posts tagged with &quot;Gallio&quot;"><span class="label label-info">Gallio</span></a>     <a href="/tags/MSBuild" rel="tooltip" title="View posts tagged with &quot;MSBuild&quot;"><span class="label label-info">MSBuild</span></a>     <a href="/tags/NCover" rel="tooltip" title="View posts tagged with &quot;NCover&quot;"><span class="label label-info">NCover</span></a>     <a href="/tags/NUnit" rel="tooltip" title="View posts tagged with &quot;NUnit&quot;"><span class="label label-info">NUnit</span></a>     <a href="/tags/tdd" rel="tooltip" title="View posts tagged with &quot;tdd&quot;"><span class="label label-info">tdd</span></a>     <a href="/tags/TeamCity" rel="tooltip" title="View posts tagged with &quot;TeamCity&quot;"><span class="label label-info">TeamCity</span></a>     <a href="/tags/Test" rel="tooltip" title="View posts tagged with &quot;Test&quot;"><span class="label label-info">Test</span></a>     <a href="/tags/unit" rel="tooltip" title="View posts tagged with &quot;unit&quot;"><span class="label label-info">unit</span></a>     <a href="/tags/xUnit" rel="tooltip" title="View posts tagged with &quot;xUnit&quot;"><span class="label label-info">xUnit</span></a>     <a href="/tags/CI" rel="tooltip" title="View posts tagged with &quot;CI&quot;"><span class="label label-info">CI</span></a>     <a href="/tags/Task" rel="tooltip" title="View posts tagged with &quot;Task&quot;"><span class="label label-info">Task</span></a>     <a href="/tags/TODO" rel="tooltip" title="View posts tagged with &quot;TODO&quot;"><span class="label label-info">TODO</span></a>     <a href="/tags/Dynamic" rel="tooltip" title="View posts tagged with &quot;Dynamic&quot;"><span class="label label-info">Dynamic</span></a>     <a href="/tags/Challenge" rel="tooltip" title="View posts tagged with &quot;Challenge&quot;"><span class="label label-info">Challenge</span></a>     <a href="/tags/LINQ" rel="tooltip" title="View posts tagged with &quot;LINQ&quot;"><span class="label label-info">LINQ</span></a>     <a href="/tags/combinatorics" rel="tooltip" title="View posts tagged with &quot;combinatorics&quot;"><span class="label label-info">combinatorics</span></a>     <a href="/tags/countdown" rel="tooltip" title="View posts tagged with &quot;countdown&quot;"><span class="label label-info">countdown</span></a>     <a href="/tags/f#" rel="tooltip" title="View posts tagged with &quot;f#&quot;"><span class="label label-info">f#</span></a>     <a href="/tags/permutation" rel="tooltip" title="View posts tagged with &quot;permutation&quot;"><span class="label label-info">permutation</span></a>     <a href="/tags/ESB" rel="tooltip" title="View posts tagged with &quot;ESB&quot;"><span class="label label-info">ESB</span></a>     <a href="/tags/extensibility" rel="tooltip" title="View posts tagged with &quot;extensibility&quot;"><span class="label label-info">extensibility</span></a>     <a href="/tags/NServiceBus" rel="tooltip" title="View posts tagged with &quot;NServiceBus&quot;"><span class="label label-info">NServiceBus</span></a>   
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
  <div class="container">
	<p class="pull-right"> <a href="/2010/01/10/a-coupon-for-any-tekpub-series-to-give-away/" title="Previous Post: A coupon for any Tekpub series to give away">&laquo; Previous Blog Post</a> 	  |  <a href="#">Back to top</a>  |   	<a href="/2010/08/09/harmful-abstractions/" title="Next Post: Harmful Abstractions">Next Blog Post &raquo; </a> 	 </p>        
	<p>Page last generated on April 15, 2013</p>
	<p>If need be, <a href="https://github.com/mouk/Feedback/issues/new" title="Leave feedback for Moukarram Kabbash"  target="_blank" >leave me some feedback</a>.</p>	
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>	
  </div>
</footer>

<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'abstractast';

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>

<!-- Google Analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  var pluginUrl = '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-10348417-1']);
  _gaq.push(['_setDomainName', 'bstractast.com']);
  _gaq.push(['_setAllowLinker', true]);
  
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
  </body>
</html>
